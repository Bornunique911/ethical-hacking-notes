# Jr Penetration Tester

1. [Introduction to Pentesting](#introduction-to-pentesting)
2. [Introduction to Web Hacking](#introduction-to-web-hacking)
3. [Burp Suite](#burp-suite)
4. [Network Security](#network-security)
5. [Vulnerability Research](#vulnerability-research)
6. [Metasploit](#metasploit)
7. [Privilege Escalation](#privilege-escalation)

## Introduction to Pentesting

---

* Pentest (Penetration test) - ethical attempt to test & analyze security to protect assets; involves using tools and techniques to attempt breaking the system; authorised audit.

* ROE (Rules of Engagement) - document created at initial stages of pentest, includes permission, test scope and rules.

* Stages of pentest:

  1. Information gathering
  2. Enumeration, scanning
  3. Exploitation
  4. Privilege escalation
  5. Post-exploitation (pivoting, covering tracks, reporting)

* Pentest methodologies:

  * OSSTMM (Open Source Security Testing Methodology Manual)
  * OWASP (Open Web Application Security Project)
  * NIST (National Institute of Standards and Technology) Cybersecurity Framework
  * NCSC CAF (National Cyber Security Centre - Cyber Assessment Framework)

* Types of pentests:

  * Black-box testing - No knowledge; high-level process
  * Grey-box testing - Partial knowledge
  * White-box testing - Full knowledge; low-level process

* CIA triad - Confidentiality, Integrity and Availability.

* PIM (Privileged Identity Management) - used to translate a user's role within an organisation into an access role on a system.

* PAM (Privileged Access Management) - management of privileges a system's access role has.

* Threat modelling - process of reviewing, improving and testing security protocols in place in an organisation's IT infra and services.

* A threat model includes:

  * Threat intelligence
  * Asset identification
  * Mitigation capabilities
  * Risk assessment

## Introduction to Web Hacking

---

* We can manually review a web app for security issues using in-built tools in our browser, such as View Source, Inspector, Debugger, Network, etc.

* The three methods of Content Discovery in web apps are:
  
  * Manual -

    ```shell
    #We can use the favicon link of a website to find the framework used
    curl https://website.com/favicon.ico | md5sum
    #this calculates md5 hash value after downloading the favicon
    #hash can be used to lookup on <https://wiki.owasp.org/index.php/OWASP_favicon_database>
    ```

    ```shell
    #Manually discovering HTTP headers
    curl http://website.com/ -v
    ```

  * Automated -

    ```shell
    #using wordlists
    #common tools are ffuf, dirb, gobuster - all do the same function
    ffuf -w /usr/share/wordlists/dirbuster.txt -u http://10.0.2.7/FUZZ

    dirb http://10.0.2.7/ /usr/share/wordlists/dirbuster.txt

    gobuster dir --url http://10.0.2.7/ -w /usr/share/wordlists/dirbuster.txt
    ```

  * OSINT (Open Source Intelligence) - OSINT includes methods such as advanced Google searching, checking archives or using applications such as Wappalyzer and S3 buckets.

* Subdomain enumeration - finding valid subdomains for a domain. Its methods are:

  * OSINT - using public info with the help of sites such as <http://crt.sh/> and <https://transparencyreport.google.com/https/certificates> to get a list of SSL/TLS certificates and discover subdomains. OSINT includes advanced Googling as well as using automated tools like ```Sublist3r```

  * Bruteforce - bruteforce DNS enumeration is trying different possible subdomains from a list of commonly used ones. As it involves a high number of requests, it is automated using tools such as ```dnsrecon```.

  * Virtual hosts - as some subdomains are not always hosted in public DNS results and are instead stored in private DNS server or in developer's machines in '/etc/hosts' file, we can use the Host header when accessing websites and modify it. This process can be automated too.

    ```shell
    ffuf -w /usr/share/wordlists/dnsnamelist.txt -H "Host:FUZZ.acmeitsupport.thm" -u http://10.10.3.35 -fs {size} #replace {size} with any page size
    #-H flag is used for header
    #-fs is used for filtering output by page size
    ```

* Authentication bypass -

  * Username enumeration -

    ```shell
    #a list of valid usernames can be created on basis of error message
    ffuf -w /usr/share/wordlists/names.txt -X POST -d "username=FUZZ&email=x&password=x" -H "Content-Type:application/x-www-form-urlencoded" -u http://10.10.131.237/customers/signup -mr "username already exists"
    #-X specifies request method
    #-d is for data that we will send
    #-H is for extra headers added to request
    #-mr is the text or error we are looking for a valid username
    ```

  * Brute force -

    ```shell
    #we can use valid usernames to brute force login pages
    ffuf -w valid_usernames.txt:W1, /usr/share/wordlists/passwords.txt:W2 -X POST -d "username=W1&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.131.237/customers/login -fc 200
    #multiple wordlists, so instead of using FUZZ we have to use custom terms
    #-fc is used for status code other than 200, for positive match
    ```

  * Logic flaw - typical logical path of app is bypassed, circumvented or manipulated.

  * Cookie tampering - For plaintext cookies, we can simply modify cookies. For hashed cookies, however, we have to use resources such as <https://crackstation.net/>. If the cookies are encoded using base32 or base64, we can simply decode, modify and encode the cookie string to bypass login.

    ```shell
    curl http://10.10.131.237/cookie-test #returns message 'Not Logged In'

    curl -H "Cookie: logged_in=true;admin=false" http://10.10.131.237/cookie-test #logged in

    curl -H "Cookie: logged_in=true;admin=true" http://10.10.131.237/cookie-test #logged in as Admin
    ```

* IDOR (Insecure Direct Object Reference) - a type of access control vulnerability; occurs when a web server receives user input to retrieve objects without validation on server-side to confirm the requested object belongs to the one requesting it. Examples include:

  * Websites such as <https://website.com/profile?userid=1002>, where the userid field can be manipulated.

  * Data being sent to server is encoded using base64. In these instances, we can simply decode and encode modified data and submit it.

  * Hashing IDs; if they are predictable, they can be cracked using services like <https://crackstation.net/>.

  * IDOR detection by creating two accounts on the same website, and swapping the IDs between them. If the other users' content can be viewed using their ID but not by logging into their account, then it is a valid IDOR vulnerability.

## Burp Suite

---

## Network Security

---

## Vulnerability Research

---

## Metasploit

---

## Privilege Escalation

---
